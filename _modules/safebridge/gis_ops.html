

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>safebridge.gis_ops &mdash; SafeBridge 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/my_theme.css?v=a0fc712e" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            SafeBridge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">safebridge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SafeBridge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">safebridge.gis_ops</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for safebridge.gis_ops</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides functions to perform various GIS operations such as extracting edges from polygons, extending lines, moving lines to points, and splitting polygons with multiple lines. It uses the Shapely library for geometric operations and supports WKB (Well-Known Binary) format for input geometries.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.affinity</span><span class="w"> </span><span class="kn">import</span> <span class="n">scale</span><span class="p">,</span> <span class="n">translate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">Point</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.wkb</span><span class="w"> </span><span class="kn">import</span> <span class="n">loads</span> <span class="k">as</span> <span class="n">wkbloads</span>


<div class="viewcode-block" id="extract_intersecting_edges">
<a class="viewcode-back" href="../../safebridge.html#safebridge.gis_ops.extract_intersecting_edges">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extract_intersecting_edges</span><span class="p">(</span><span class="n">polygon</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LineString</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Extracts the edges of a polygon that intersect with a given line.</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    polygon : bytes</span>
<span class="sd">        The Well-Known-Binary (WKB) representation of the polygon.</span>
<span class="sd">    line : bytes</span>
<span class="sd">        The WKB representation of the line.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[LineString] : A list of LineString objects representing the intersecting edges.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">polygon</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">wkbloads</span><span class="p">(</span><span class="n">polygon</span><span class="p">),</span> <span class="n">wkbloads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">boundary_coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundary_coords</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([</span><span class="n">boundary_coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">boundary_coords</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">edge</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">sort_by_centroid</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span></div>


<div class="viewcode-block" id="sort_by_centroid">
<a class="viewcode-back" href="../../safebridge.html#safebridge.gis_ops.sort_by_centroid">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sort_by_centroid</span><span class="p">(</span><span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">LineString</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LineString</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sorts a list of LineString objects by their centroid coordinates.</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    edges : [LineString]</span>
<span class="sd">        A list of LineString objects to be sorted.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[LineString] : A sorted list of LineString objects based on their centroid coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">centroid</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
    <span class="n">sorted_cents</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">point</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
    <span class="n">sorted_geom</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_cents</span><span class="p">:</span>
        <span class="n">sorted_geom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">centroids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">sorted_geom</span></div>


<div class="viewcode-block" id="extend_line">
<a class="viewcode-back" href="../../safebridge.html#safebridge.gis_ops.extend_line">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extend_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span><span class="n">LineString</span><span class="p">,</span> <span class="n">extend_length</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LineString</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Extends a line by a specified length on both ends.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    line : LineString</span>
<span class="sd">        The LineString object to be extended.</span>
<span class="sd">    extend_length : float</span>
<span class="sd">        The length by which to extend the line on both ends.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LineString : A new LineString object that has been extended by the specified length.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">centroid</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">centroid</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">extend_length</span><span class="p">)</span> <span class="o">/</span> <span class="n">line</span><span class="o">.</span><span class="n">length</span>
    <span class="n">extended_line</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">xfact</span><span class="o">=</span><span class="n">factor</span><span class="p">,</span> <span class="n">yfact</span><span class="o">=</span><span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">centroid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">extended_line</span></div>


<div class="viewcode-block" id="move_line2point">
<a class="viewcode-back" href="../../safebridge.html#safebridge.gis_ops.move_line2point">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">move_line2point</span><span class="p">(</span><span class="n">line</span><span class="p">:</span><span class="n">LineString</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span><span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LineString</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Moves a line to a point.</span>
<span class="sd">    </span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    line : LineString</span>
<span class="sd">        The LineString object to be moved.</span>
<span class="sd">    point : Point</span>
<span class="sd">        The Point object to which the line will be moved.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LineString : A new LineString object that has been moved to the specified point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line_cent</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">centroid</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">line_cent</span><span class="o">.</span><span class="n">x</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">line_cent</span><span class="o">.</span><span class="n">y</span>
    <span class="n">moved_line</span> <span class="o">=</span> <span class="n">translate</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">dy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">moved_line</span></div>


<div class="viewcode-block" id="move_lines_to_points">
<a class="viewcode-back" href="../../safebridge.html#safebridge.gis_ops.move_lines_to_points">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">move_lines_to_points</span><span class="p">(</span><span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">LineString</span><span class="p">],</span> <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Point</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LineString</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Moves lines to the given points. </span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    lines : list[LineString]</span>
<span class="sd">        A list of LineString objects to be moved.</span>
<span class="sd">    points : list[Point]</span>
<span class="sd">        A list of Point objects to which the lines will be moved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[LineString] : A list of moved LineString objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">move_line2point</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">points</span><span class="p">)]</span></div>



<div class="viewcode-block" id="multisplit">
<a class="viewcode-back" href="../../safebridge.html#safebridge.gis_ops.multisplit">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">multisplit</span><span class="p">(</span><span class="n">polygon</span> <span class="p">:</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">LineString</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Polygon</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Split a polygon by multiple lines.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    polygon : Polygon</span>
<span class="sd">        The polygon to be split.</span>
<span class="sd">    lines : list[LineString]</span>
<span class="sd">        A list of LineString objects to split the polygon.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[Polygon]: A list of resulting polygons after the split.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">collection</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">temp</span><span class="o">.</span><span class="n">geoms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">geom</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
            <span class="n">collection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">geom2</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">collection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geom2</span><span class="o">.</span><span class="n">geoms</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">collection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geom2</span><span class="o">.</span><span class="n">geoms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sort_by_centroid</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, SafeStruct.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>